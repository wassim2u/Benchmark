ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 884, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 408, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1784, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 906, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: all, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 884, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 408, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1784, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 906, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 6636), ('active.all.current', 6636), ('active.all.freed', 0), ('active.all.peak', 6636), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 6636), ('active.small_pool.current', 6636), ('active.small_pool.freed', 0), ('active.small_pool.peak', 6636), ('active_bytes.all.allocated', 3715072), ('active_bytes.all.current', 3715072), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 3715072), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 3715072), ('active_bytes.small_pool.current', 3715072), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 3715072), ('allocated_bytes.all.allocated', 3715072), ('allocated_bytes.all.current', 3715072), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 3715072), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 3715072), ('allocated_bytes.small_pool.current', 3715072), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 3715072), ('allocation.all.allocated', 6636), ('allocation.all.current', 6636), ('allocation.all.freed', 0), ('allocation.all.peak', 6636), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 6636), ('allocation.small_pool.current', 6636), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 6636), ('inactive_split.all.allocated', 2), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 1), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 2), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 1), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 4193280), ('inactive_split_bytes.all.current', 479232), ('inactive_split_bytes.all.freed', 3714048), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 4193280), ('inactive_split_bytes.small_pool.current', 479232), ('inactive_split_bytes.small_pool.freed', 3714048), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 406976), ('requested_bytes.all.current', 406976), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 406976), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 406976), ('requested_bytes.small_pool.current', 406976), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 406976), ('reserved_bytes.all.allocated', 4194304), ('reserved_bytes.all.current', 4194304), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 4194304), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 4194304), ('reserved_bytes.small_pool.current', 4194304), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 4194304), ('segment.all.allocated', 2), ('segment.all.current', 2), ('segment.all.freed', 0), ('segment.all.peak', 2), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 2), ('segment.small_pool.current', 2), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 2)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 884, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 408, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: all, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 884, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 408, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 6636), ('active.all.current', 6636), ('active.all.freed', 0), ('active.all.peak', 6636), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 6636), ('active.small_pool.current', 6636), ('active.small_pool.freed', 0), ('active.small_pool.peak', 6636), ('active_bytes.all.allocated', 3715072), ('active_bytes.all.current', 3715072), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 3715072), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 3715072), ('active_bytes.small_pool.current', 3715072), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 3715072), ('allocated_bytes.all.allocated', 3715072), ('allocated_bytes.all.current', 3715072), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 3715072), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 3715072), ('allocated_bytes.small_pool.current', 3715072), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 3715072), ('allocation.all.allocated', 6636), ('allocation.all.current', 6636), ('allocation.all.freed', 0), ('allocation.all.peak', 6636), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 6636), ('allocation.small_pool.current', 6636), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 6636), ('inactive_split.all.allocated', 2), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 1), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 2), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 1), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 4193280), ('inactive_split_bytes.all.current', 479232), ('inactive_split_bytes.all.freed', 3714048), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 4193280), ('inactive_split_bytes.small_pool.current', 479232), ('inactive_split_bytes.small_pool.freed', 3714048), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 406976), ('requested_bytes.all.current', 406976), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 406976), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 406976), ('requested_bytes.small_pool.current', 406976), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 406976), ('reserved_bytes.all.allocated', 4194304), ('reserved_bytes.all.current', 4194304), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 4194304), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 4194304), ('reserved_bytes.small_pool.current', 4194304), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 4194304), ('segment.all.allocated', 2), ('segment.all.current', 2), ('segment.all.freed', 0), ('segment.all.peak', 2), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 2), ('segment.small_pool.current', 2), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 2)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 885, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 408, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: all, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 885, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 408, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 6636), ('active.all.current', 6636), ('active.all.freed', 0), ('active.all.peak', 6636), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 6636), ('active.small_pool.current', 6636), ('active.small_pool.freed', 0), ('active.small_pool.peak', 6636), ('active_bytes.all.allocated', 3715072), ('active_bytes.all.current', 3715072), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 3715072), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 3715072), ('active_bytes.small_pool.current', 3715072), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 3715072), ('allocated_bytes.all.allocated', 3715072), ('allocated_bytes.all.current', 3715072), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 3715072), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 3715072), ('allocated_bytes.small_pool.current', 3715072), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 3715072), ('allocation.all.allocated', 6636), ('allocation.all.current', 6636), ('allocation.all.freed', 0), ('allocation.all.peak', 6636), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 6636), ('allocation.small_pool.current', 6636), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 6636), ('inactive_split.all.allocated', 2), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 1), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 2), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 1), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 4193280), ('inactive_split_bytes.all.current', 479232), ('inactive_split_bytes.all.freed', 3714048), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 4193280), ('inactive_split_bytes.small_pool.current', 479232), ('inactive_split_bytes.small_pool.freed', 3714048), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 406976), ('requested_bytes.all.current', 406976), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 406976), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 406976), ('requested_bytes.small_pool.current', 406976), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 406976), ('reserved_bytes.all.allocated', 4194304), ('reserved_bytes.all.current', 4194304), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 4194304), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 4194304), ('reserved_bytes.small_pool.current', 4194304), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 4194304), ('segment.all.allocated', 2), ('segment.all.current', 2), ('segment.all.freed', 0), ('segment.all.peak', 2), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 2), ('segment.small_pool.current', 2), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 2)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 885, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 408, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 888, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 411, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 887, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 410, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 887, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 410, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 887, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 410, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: all, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 887, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 410, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 6636), ('active.all.current', 6636), ('active.all.freed', 0), ('active.all.peak', 6636), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 6636), ('active.small_pool.current', 6636), ('active.small_pool.freed', 0), ('active.small_pool.peak', 6636), ('active_bytes.all.allocated', 3715072), ('active_bytes.all.current', 3715072), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 3715072), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 3715072), ('active_bytes.small_pool.current', 3715072), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 3715072), ('allocated_bytes.all.allocated', 3715072), ('allocated_bytes.all.current', 3715072), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 3715072), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 3715072), ('allocated_bytes.small_pool.current', 3715072), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 3715072), ('allocation.all.allocated', 6636), ('allocation.all.current', 6636), ('allocation.all.freed', 0), ('allocation.all.peak', 6636), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 6636), ('allocation.small_pool.current', 6636), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 6636), ('inactive_split.all.allocated', 2), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 1), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 2), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 1), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 4193280), ('inactive_split_bytes.all.current', 479232), ('inactive_split_bytes.all.freed', 3714048), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 4193280), ('inactive_split_bytes.small_pool.current', 479232), ('inactive_split_bytes.small_pool.freed', 3714048), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 406976), ('requested_bytes.all.current', 406976), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 406976), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 406976), ('requested_bytes.small_pool.current', 406976), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 406976), ('reserved_bytes.all.allocated', 4194304), ('reserved_bytes.all.current', 4194304), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 4194304), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 4194304), ('reserved_bytes.small_pool.current', 4194304), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 4194304), ('segment.all.allocated', 2), ('segment.all.current', 2), ('segment.all.freed', 0), ('segment.all.peak', 2), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 2), ('segment.small_pool.current', 2), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 2)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= flores200 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 884, in <module>
  File "benchmark_suite.py", line 408, in call_batched
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1784, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 906, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 9954), ('active.all.current', 6636), ('active.all.freed', 3318), ('active.all.peak', 9954), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 9954), ('active.small_pool.current', 6636), ('active.small_pool.freed', 3318), ('active.small_pool.peak', 9954), ('active_bytes.all.allocated', 5572608), ('active_bytes.all.current', 3715072), ('active_bytes.all.freed', 1857536), ('active_bytes.all.peak', 5572608), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 5572608), ('active_bytes.small_pool.current', 3715072), ('active_bytes.small_pool.freed', 1857536), ('active_bytes.small_pool.peak', 5572608), ('allocated_bytes.all.allocated', 5572608), ('allocated_bytes.all.current', 3715072), ('allocated_bytes.all.freed', 1857536), ('allocated_bytes.all.peak', 5572608), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 5572608), ('allocated_bytes.small_pool.current', 3715072), ('allocated_bytes.small_pool.freed', 1857536), ('allocated_bytes.small_pool.peak', 5572608), ('allocation.all.allocated', 9954), ('allocation.all.current', 6636), ('allocation.all.freed', 3318), ('allocation.all.peak', 9954), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 9954), ('allocation.small_pool.current', 6636), ('allocation.small_pool.freed', 3318), ('allocation.small_pool.peak', 9954), ('inactive_split.all.allocated', 5), ('inactive_split.all.current', 3), ('inactive_split.all.freed', 2), ('inactive_split.all.peak', 3), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 5), ('inactive_split.small_pool.current', 3), ('inactive_split.small_pool.freed', 2), ('inactive_split.small_pool.peak', 3), ('inactive_split_bytes.all.allocated', 8147456), ('inactive_split_bytes.all.current', 2576384), ('inactive_split_bytes.all.freed', 5571072), ('inactive_split_bytes.all.peak', 2576384), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 8147456), ('inactive_split_bytes.small_pool.current', 2576384), ('inactive_split_bytes.small_pool.freed', 5571072), ('inactive_split_bytes.small_pool.peak', 2576384), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 610464), ('requested_bytes.all.current', 406976), ('requested_bytes.all.freed', 203488), ('requested_bytes.all.peak', 610464), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 610464), ('requested_bytes.small_pool.current', 406976), ('requested_bytes.small_pool.freed', 203488), ('requested_bytes.small_pool.peak', 610464), ('reserved_bytes.all.allocated', 6291456), ('reserved_bytes.all.current', 6291456), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 6291456), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 6291456), ('reserved_bytes.small_pool.current', 6291456), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 6291456), ('segment.all.allocated', 3), ('segment.all.current', 3), ('segment.all.freed', 0), ('segment.all.peak', 3), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 3), ('segment.small_pool.current', 3), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 3)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 890, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 410, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 888, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 410, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 888, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 410, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 888, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 410, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 895, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 413, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 897, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 413, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 897, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 413, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: all, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 897, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 413, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 6636), ('active.all.current', 6636), ('active.all.freed', 0), ('active.all.peak', 6636), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 6636), ('active.small_pool.current', 6636), ('active.small_pool.freed', 0), ('active.small_pool.peak', 6636), ('active_bytes.all.allocated', 3715072), ('active_bytes.all.current', 3715072), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 3715072), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 3715072), ('active_bytes.small_pool.current', 3715072), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 3715072), ('allocated_bytes.all.allocated', 3715072), ('allocated_bytes.all.current', 3715072), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 3715072), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 3715072), ('allocated_bytes.small_pool.current', 3715072), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 3715072), ('allocation.all.allocated', 6636), ('allocation.all.current', 6636), ('allocation.all.freed', 0), ('allocation.all.peak', 6636), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 6636), ('allocation.small_pool.current', 6636), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 6636), ('inactive_split.all.allocated', 2), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 1), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 2), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 1), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 4193280), ('inactive_split_bytes.all.current', 479232), ('inactive_split_bytes.all.freed', 3714048), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 4193280), ('inactive_split_bytes.small_pool.current', 479232), ('inactive_split_bytes.small_pool.freed', 3714048), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 406976), ('requested_bytes.all.current', 406976), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 406976), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 406976), ('requested_bytes.small_pool.current', 406976), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 406976), ('reserved_bytes.all.allocated', 4194304), ('reserved_bytes.all.current', 4194304), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 4194304), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 4194304), ('reserved_bytes.small_pool.current', 4194304), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 4194304), ('segment.all.allocated', 2), ('segment.all.current', 2), ('segment.all.freed', 0), ('segment.all.peak', 2), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 2), ('segment.small_pool.current', 2), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 2)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= flores200 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 897, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 413, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 9954), ('active.all.current', 9720), ('active.all.freed', 234), ('active.all.peak', 9954), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 9954), ('active.small_pool.current', 9720), ('active.small_pool.freed', 234), ('active.small_pool.peak', 9954), ('active_bytes.all.allocated', 5572608), ('active_bytes.all.current', 5294080), ('active_bytes.all.freed', 278528), ('active_bytes.all.peak', 5572608), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 5572608), ('active_bytes.small_pool.current', 5294080), ('active_bytes.small_pool.freed', 278528), ('active_bytes.small_pool.peak', 5572608), ('allocated_bytes.all.allocated', 5572608), ('allocated_bytes.all.current', 5294080), ('allocated_bytes.all.freed', 278528), ('allocated_bytes.all.peak', 5572608), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 5572608), ('allocated_bytes.small_pool.current', 5294080), ('allocated_bytes.small_pool.freed', 278528), ('allocated_bytes.small_pool.peak', 5572608), ('allocation.all.allocated', 9954), ('allocation.all.current', 9720), ('allocation.all.freed', 234), ('allocation.all.peak', 9954), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 9954), ('allocation.small_pool.current', 9720), ('allocation.small_pool.freed', 234), ('allocation.small_pool.peak', 9954), ('inactive_split.all.allocated', 16), ('inactive_split.all.current', 14), ('inactive_split.all.freed', 2), ('inactive_split.all.peak', 14), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 16), ('inactive_split.small_pool.current', 14), ('inactive_split.small_pool.freed', 2), ('inactive_split.small_pool.peak', 14), ('inactive_split_bytes.all.allocated', 6568448), ('inactive_split_bytes.all.current', 997376), ('inactive_split_bytes.all.freed', 5571072), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 6568448), ('inactive_split_bytes.small_pool.current', 997376), ('inactive_split_bytes.small_pool.freed', 5571072), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 610464), ('requested_bytes.all.current', 419312), ('requested_bytes.all.freed', 191152), ('requested_bytes.all.peak', 610464), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 610464), ('requested_bytes.small_pool.current', 419312), ('requested_bytes.small_pool.freed', 191152), ('requested_bytes.small_pool.peak', 610464), ('reserved_bytes.all.allocated', 6291456), ('reserved_bytes.all.current', 6291456), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 6291456), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 6291456), ('reserved_bytes.small_pool.current', 6291456), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 6291456), ('segment.all.allocated', 3), ('segment.all.current', 3), ('segment.all.freed', 0), ('segment.all.peak', 3), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 3), ('segment.small_pool.current', 3), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 3)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: all, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= flores200 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 897, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 413, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 13272), ('active.all.current', 12804), ('active.all.freed', 468), ('active.all.peak', 13038), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 13272), ('active.small_pool.current', 12804), ('active.small_pool.freed', 468), ('active.small_pool.peak', 13038), ('active_bytes.all.allocated', 7430144), ('active_bytes.all.current', 6873088), ('active_bytes.all.freed', 557056), ('active_bytes.all.peak', 7151616), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 7430144), ('active_bytes.small_pool.current', 6873088), ('active_bytes.small_pool.freed', 557056), ('active_bytes.small_pool.peak', 7151616), ('allocated_bytes.all.allocated', 7430144), ('allocated_bytes.all.current', 6873088), ('allocated_bytes.all.freed', 557056), ('allocated_bytes.all.peak', 7151616), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 7430144), ('allocated_bytes.small_pool.current', 6873088), ('allocated_bytes.small_pool.freed', 557056), ('allocated_bytes.small_pool.peak', 7151616), ('allocation.all.allocated', 13272), ('allocation.all.current', 12804), ('allocation.all.freed', 468), ('allocation.all.peak', 13038), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 13272), ('allocation.small_pool.current', 12804), ('allocation.small_pool.freed', 468), ('allocation.small_pool.peak', 13038), ('inactive_split.all.allocated', 30), ('inactive_split.all.current', 14), ('inactive_split.all.freed', 16), ('inactive_split.all.peak', 14), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 30), ('inactive_split.small_pool.current', 14), ('inactive_split.small_pool.freed', 16), ('inactive_split.small_pool.peak', 14), ('inactive_split_bytes.all.allocated', 8943616), ('inactive_split_bytes.all.current', 1515520), ('inactive_split_bytes.all.freed', 7428096), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 8943616), ('inactive_split_bytes.small_pool.current', 1515520), ('inactive_split_bytes.small_pool.freed', 7428096), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 813952), ('requested_bytes.all.current', 431648), ('requested_bytes.all.freed', 382304), ('requested_bytes.all.peak', 622800), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 813952), ('requested_bytes.small_pool.current', 431648), ('requested_bytes.small_pool.freed', 382304), ('requested_bytes.small_pool.peak', 622800), ('reserved_bytes.all.allocated', 8388608), ('reserved_bytes.all.current', 8388608), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 8388608), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 8388608), ('reserved_bytes.small_pool.current', 8388608), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 8388608), ('segment.all.allocated', 4), ('segment.all.current', 4), ('segment.all.freed', 0), ('segment.all.peak', 4), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 4), ('segment.small_pool.current', 4), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 4)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: all, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= flores200 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 884, in <module>
    "beam_size": beam_size,
  File "benchmark_suite.py", line 408, in call_batched
    print("what1")
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1784, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer-env4/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 906, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 13272), ('active.all.current', 6636), ('active.all.freed', 6636), ('active.all.peak', 9954), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 13272), ('active.small_pool.current', 6636), ('active.small_pool.freed', 6636), ('active.small_pool.peak', 9954), ('active_bytes.all.allocated', 7430144), ('active_bytes.all.current', 3715072), ('active_bytes.all.freed', 3715072), ('active_bytes.all.peak', 5572608), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 7430144), ('active_bytes.small_pool.current', 3715072), ('active_bytes.small_pool.freed', 3715072), ('active_bytes.small_pool.peak', 5572608), ('allocated_bytes.all.allocated', 7430144), ('allocated_bytes.all.current', 3715072), ('allocated_bytes.all.freed', 3715072), ('allocated_bytes.all.peak', 5572608), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 7430144), ('allocated_bytes.small_pool.current', 3715072), ('allocated_bytes.small_pool.freed', 3715072), ('allocated_bytes.small_pool.peak', 5572608), ('allocation.all.allocated', 13272), ('allocation.all.current', 6636), ('allocation.all.freed', 6636), ('allocation.all.peak', 9954), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 13272), ('allocation.small_pool.current', 6636), ('allocation.small_pool.freed', 6636), ('allocation.small_pool.peak', 9954), ('inactive_split.all.allocated', 7), ('inactive_split.all.current', 2), ('inactive_split.all.freed', 5), ('inactive_split.all.peak', 3), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 7), ('inactive_split.small_pool.current', 2), ('inactive_split.small_pool.freed', 5), ('inactive_split.small_pool.peak', 3), ('inactive_split_bytes.all.allocated', 10004992), ('inactive_split_bytes.all.current', 2576384), ('inactive_split_bytes.all.freed', 7428608), ('inactive_split_bytes.all.peak', 2576384), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 10004992), ('inactive_split_bytes.small_pool.current', 2576384), ('inactive_split_bytes.small_pool.freed', 7428608), ('inactive_split_bytes.small_pool.peak', 2576384), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 813952), ('requested_bytes.all.current', 406976), ('requested_bytes.all.freed', 406976), ('requested_bytes.all.peak', 610464), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 813952), ('requested_bytes.small_pool.current', 406976), ('requested_bytes.small_pool.freed', 406976), ('requested_bytes.small_pool.peak', 610464), ('reserved_bytes.all.allocated', 6291456), ('reserved_bytes.all.current', 6291456), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 6291456), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 6291456), ('reserved_bytes.small_pool.current', 6291456), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 6291456), ('segment.all.allocated', 3), ('segment.all.current', 3), ('segment.all.freed', 0), ('segment.all.peak', 3), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 3), ('segment.small_pool.current', 3), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 3)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 897, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 413, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 901, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 389, in call_batched
    tokenized_datasets = filtered_dataset.map(
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 578, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 543, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 3073, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 3449, in _map_single
    batch = apply_function_on_filtered_inputs(
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 3330, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "benchmark_suite.py", line 653, in preprocess_function_with_text_target
    return self.tokenizer(inputs, decoder_start_token_id=0)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/tokenization_utils_base.py", line 2548, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/tokenization_utils_base.py", line 2634, in _call_one
    return self.batch_encode_plus(
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/tokenization_utils_base.py", line 2825, in batch_encode_plus
    return self._batch_encode_plus(
TypeError: _batch_encode_plus() got an unexpected keyword argument 'decoder_start_token_id'
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 901, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 389, in call_batched
    tokenized_datasets = filtered_dataset.map(
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 578, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 543, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 3073, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 3449, in _map_single
    batch = apply_function_on_filtered_inputs(
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 3330, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "benchmark_suite.py", line 653, in preprocess_function_with_text_target
    return self.tokenizer(inputs, decoder_start_token_id=0, text_target=targets)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/tokenization_utils_base.py", line 2548, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/tokenization_utils_base.py", line 2634, in _call_one
    return self.batch_encode_plus(
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/tokenization_utils_base.py", line 2825, in batch_encode_plus
    return self._batch_encode_plus(
TypeError: _batch_encode_plus() got an unexpected keyword argument 'decoder_start_token_id'
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: all, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 901, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 389, in call_batched
    tokenized_datasets = filtered_dataset.map(
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 578, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 543, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 3073, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 3449, in _map_single
    batch = apply_function_on_filtered_inputs(
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/datasets/arrow_dataset.py", line 3330, in apply_function_on_filtered_inputs
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
  File "benchmark_suite.py", line 653, in preprocess_function_with_text_target
    return self.tokenizer(inputs, decoder_start_token_id=0, text_target=targets)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/tokenization_utils_base.py", line 2548, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/tokenization_utils_base.py", line 2634, in _call_one
    return self.batch_encode_plus(
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/tokenization_utils_base.py", line 2825, in batch_encode_plus
    return self._batch_encode_plus(
TypeError: _batch_encode_plus() got an unexpected keyword argument 'decoder_start_token_id'
OrderedDict([('active.all.allocated', 6636), ('active.all.current', 6636), ('active.all.freed', 0), ('active.all.peak', 6636), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 6636), ('active.small_pool.current', 6636), ('active.small_pool.freed', 0), ('active.small_pool.peak', 6636), ('active_bytes.all.allocated', 3715072), ('active_bytes.all.current', 3715072), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 3715072), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 3715072), ('active_bytes.small_pool.current', 3715072), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 3715072), ('allocated_bytes.all.allocated', 3715072), ('allocated_bytes.all.current', 3715072), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 3715072), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 3715072), ('allocated_bytes.small_pool.current', 3715072), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 3715072), ('allocation.all.allocated', 6636), ('allocation.all.current', 6636), ('allocation.all.freed', 0), ('allocation.all.peak', 6636), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 6636), ('allocation.small_pool.current', 6636), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 6636), ('inactive_split.all.allocated', 2), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 1), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 2), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 1), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 4193280), ('inactive_split_bytes.all.current', 479232), ('inactive_split_bytes.all.freed', 3714048), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 4193280), ('inactive_split_bytes.small_pool.current', 479232), ('inactive_split_bytes.small_pool.freed', 3714048), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 406976), ('requested_bytes.all.current', 406976), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 406976), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 406976), ('requested_bytes.small_pool.current', 406976), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 406976), ('reserved_bytes.all.allocated', 4194304), ('reserved_bytes.all.current', 4194304), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 4194304), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 4194304), ('reserved_bytes.small_pool.current', 4194304), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 4194304), ('segment.all.allocated', 2), ('segment.all.current', 2), ('segment.all.freed', 0), ('segment.all.peak', 2), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 2), ('segment.small_pool.current', 2), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 2)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 899, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 413, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 899, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 413, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 901, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 413, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 901, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 413, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: all, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 901, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 413, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 6636), ('active.all.current', 6636), ('active.all.freed', 0), ('active.all.peak', 6636), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 6636), ('active.small_pool.current', 6636), ('active.small_pool.freed', 0), ('active.small_pool.peak', 6636), ('active_bytes.all.allocated', 3715072), ('active_bytes.all.current', 3715072), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 3715072), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 3715072), ('active_bytes.small_pool.current', 3715072), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 3715072), ('allocated_bytes.all.allocated', 3715072), ('allocated_bytes.all.current', 3715072), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 3715072), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 3715072), ('allocated_bytes.small_pool.current', 3715072), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 3715072), ('allocation.all.allocated', 6636), ('allocation.all.current', 6636), ('allocation.all.freed', 0), ('allocation.all.peak', 6636), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 6636), ('allocation.small_pool.current', 6636), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 6636), ('inactive_split.all.allocated', 2), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 1), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 2), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 1), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 4193280), ('inactive_split_bytes.all.current', 479232), ('inactive_split_bytes.all.freed', 3714048), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 4193280), ('inactive_split_bytes.small_pool.current', 479232), ('inactive_split_bytes.small_pool.freed', 3714048), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 406976), ('requested_bytes.all.current', 406976), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 406976), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 406976), ('requested_bytes.small_pool.current', 406976), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 406976), ('reserved_bytes.all.allocated', 4194304), ('reserved_bytes.all.current', 4194304), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 4194304), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 4194304), ('reserved_bytes.small_pool.current', 4194304), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 4194304), ('segment.all.allocated', 2), ('segment.all.current', 2), ('segment.all.freed', 0), ('segment.all.peak', 2), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 2), ('segment.small_pool.current', 2), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 2)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= flores200 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 901, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 413, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 9954), ('active.all.current', 9720), ('active.all.freed', 234), ('active.all.peak', 9954), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 9954), ('active.small_pool.current', 9720), ('active.small_pool.freed', 234), ('active.small_pool.peak', 9954), ('active_bytes.all.allocated', 5572608), ('active_bytes.all.current', 5294080), ('active_bytes.all.freed', 278528), ('active_bytes.all.peak', 5572608), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 5572608), ('active_bytes.small_pool.current', 5294080), ('active_bytes.small_pool.freed', 278528), ('active_bytes.small_pool.peak', 5572608), ('allocated_bytes.all.allocated', 5572608), ('allocated_bytes.all.current', 5294080), ('allocated_bytes.all.freed', 278528), ('allocated_bytes.all.peak', 5572608), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 5572608), ('allocated_bytes.small_pool.current', 5294080), ('allocated_bytes.small_pool.freed', 278528), ('allocated_bytes.small_pool.peak', 5572608), ('allocation.all.allocated', 9954), ('allocation.all.current', 9720), ('allocation.all.freed', 234), ('allocation.all.peak', 9954), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 9954), ('allocation.small_pool.current', 9720), ('allocation.small_pool.freed', 234), ('allocation.small_pool.peak', 9954), ('inactive_split.all.allocated', 16), ('inactive_split.all.current', 14), ('inactive_split.all.freed', 2), ('inactive_split.all.peak', 14), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 16), ('inactive_split.small_pool.current', 14), ('inactive_split.small_pool.freed', 2), ('inactive_split.small_pool.peak', 14), ('inactive_split_bytes.all.allocated', 6568448), ('inactive_split_bytes.all.current', 997376), ('inactive_split_bytes.all.freed', 5571072), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 6568448), ('inactive_split_bytes.small_pool.current', 997376), ('inactive_split_bytes.small_pool.freed', 5571072), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 610464), ('requested_bytes.all.current', 419312), ('requested_bytes.all.freed', 191152), ('requested_bytes.all.peak', 610464), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 610464), ('requested_bytes.small_pool.current', 419312), ('requested_bytes.small_pool.freed', 191152), ('requested_bytes.small_pool.peak', 610464), ('reserved_bytes.all.allocated', 6291456), ('reserved_bytes.all.current', 6291456), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 6291456), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 6291456), ('reserved_bytes.small_pool.current', 6291456), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 6291456), ('segment.all.allocated', 3), ('segment.all.current', 3), ('segment.all.freed', 0), ('segment.all.peak', 3), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 3), ('segment.small_pool.current', 3), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 3)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: all, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= flores200 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 901, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 413, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 13272), ('active.all.current', 12804), ('active.all.freed', 468), ('active.all.peak', 13038), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 13272), ('active.small_pool.current', 12804), ('active.small_pool.freed', 468), ('active.small_pool.peak', 13038), ('active_bytes.all.allocated', 7430144), ('active_bytes.all.current', 6873088), ('active_bytes.all.freed', 557056), ('active_bytes.all.peak', 7151616), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 7430144), ('active_bytes.small_pool.current', 6873088), ('active_bytes.small_pool.freed', 557056), ('active_bytes.small_pool.peak', 7151616), ('allocated_bytes.all.allocated', 7430144), ('allocated_bytes.all.current', 6873088), ('allocated_bytes.all.freed', 557056), ('allocated_bytes.all.peak', 7151616), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 7430144), ('allocated_bytes.small_pool.current', 6873088), ('allocated_bytes.small_pool.freed', 557056), ('allocated_bytes.small_pool.peak', 7151616), ('allocation.all.allocated', 13272), ('allocation.all.current', 12804), ('allocation.all.freed', 468), ('allocation.all.peak', 13038), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 13272), ('allocation.small_pool.current', 12804), ('allocation.small_pool.freed', 468), ('allocation.small_pool.peak', 13038), ('inactive_split.all.allocated', 30), ('inactive_split.all.current', 14), ('inactive_split.all.freed', 16), ('inactive_split.all.peak', 14), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 30), ('inactive_split.small_pool.current', 14), ('inactive_split.small_pool.freed', 16), ('inactive_split.small_pool.peak', 14), ('inactive_split_bytes.all.allocated', 8943616), ('inactive_split_bytes.all.current', 1515520), ('inactive_split_bytes.all.freed', 7428096), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 8943616), ('inactive_split_bytes.small_pool.current', 1515520), ('inactive_split_bytes.small_pool.freed', 7428096), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 813952), ('requested_bytes.all.current', 431648), ('requested_bytes.all.freed', 382304), ('requested_bytes.all.peak', 622800), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 813952), ('requested_bytes.small_pool.current', 431648), ('requested_bytes.small_pool.freed', 382304), ('requested_bytes.small_pool.peak', 622800), ('reserved_bytes.all.allocated', 8388608), ('reserved_bytes.all.current', 8388608), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 8388608), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 8388608), ('reserved_bytes.small_pool.current', 8388608), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 8388608), ('segment.all.allocated', 4), ('segment.all.current', 4), ('segment.all.freed', 0), ('segment.all.peak', 4), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 4), ('segment.small_pool.current', 4), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 4)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 900, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 413, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: 1, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 900, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 413, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 3318), ('active.all.current', 3318), ('active.all.freed', 0), ('active.all.peak', 3318), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 3318), ('active.small_pool.current', 3318), ('active.small_pool.freed', 0), ('active.small_pool.peak', 3318), ('active_bytes.all.allocated', 1857536), ('active_bytes.all.current', 1857536), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 1857536), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 1857536), ('active_bytes.small_pool.current', 1857536), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 1857536), ('allocated_bytes.all.allocated', 1857536), ('allocated_bytes.all.current', 1857536), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 1857536), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 1857536), ('allocated_bytes.small_pool.current', 1857536), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 1857536), ('allocation.all.allocated', 3318), ('allocation.all.current', 3318), ('allocation.all.freed', 0), ('allocation.all.peak', 3318), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 3318), ('allocation.small_pool.current', 3318), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 3318), ('inactive_split.all.allocated', 1), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 0), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 1), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 0), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 2096640), ('inactive_split_bytes.all.current', 239616), ('inactive_split_bytes.all.freed', 1857024), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 2096640), ('inactive_split_bytes.small_pool.current', 239616), ('inactive_split_bytes.small_pool.freed', 1857024), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 203488), ('requested_bytes.all.current', 203488), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 203488), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 203488), ('requested_bytes.small_pool.current', 203488), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 203488), ('reserved_bytes.all.allocated', 2097152), ('reserved_bytes.all.current', 2097152), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 2097152), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 2097152), ('reserved_bytes.small_pool.current', 2097152), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 2097152), ('segment.all.allocated', 1), ('segment.all.current', 1), ('segment.all.freed', 0), ('segment.all.peak', 1), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 1), ('segment.small_pool.current', 1), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 1)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: all, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 900, in <module>
    evalEngine.call_batched(batch_size=batch_size,
  File "benchmark_suite.py", line 413, in call_batched
    for batch in tqdm(eval_dataloader):
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/data/data_collator.py", line 600, in __call__
    decoder_input_ids = self.model.prepare_decoder_input_ids_from_labels(labels=features["labels"])
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1783, in prepare_decoder_input_ids_from_labels
    return self._shift_right(labels)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 905, in _shift_right
    raise ValueError(
ValueError: self.model.config.decoder_start_token_id has to be defined. In SwitchTransformers it is usually set to the pad_token_id. See SwitchTransformers docs for more information
OrderedDict([('active.all.allocated', 6636), ('active.all.current', 6636), ('active.all.freed', 0), ('active.all.peak', 6636), ('active.large_pool.allocated', 0), ('active.large_pool.current', 0), ('active.large_pool.freed', 0), ('active.large_pool.peak', 0), ('active.small_pool.allocated', 6636), ('active.small_pool.current', 6636), ('active.small_pool.freed', 0), ('active.small_pool.peak', 6636), ('active_bytes.all.allocated', 3715072), ('active_bytes.all.current', 3715072), ('active_bytes.all.freed', 0), ('active_bytes.all.peak', 3715072), ('active_bytes.large_pool.allocated', 0), ('active_bytes.large_pool.current', 0), ('active_bytes.large_pool.freed', 0), ('active_bytes.large_pool.peak', 0), ('active_bytes.small_pool.allocated', 3715072), ('active_bytes.small_pool.current', 3715072), ('active_bytes.small_pool.freed', 0), ('active_bytes.small_pool.peak', 3715072), ('allocated_bytes.all.allocated', 3715072), ('allocated_bytes.all.current', 3715072), ('allocated_bytes.all.freed', 0), ('allocated_bytes.all.peak', 3715072), ('allocated_bytes.large_pool.allocated', 0), ('allocated_bytes.large_pool.current', 0), ('allocated_bytes.large_pool.freed', 0), ('allocated_bytes.large_pool.peak', 0), ('allocated_bytes.small_pool.allocated', 3715072), ('allocated_bytes.small_pool.current', 3715072), ('allocated_bytes.small_pool.freed', 0), ('allocated_bytes.small_pool.peak', 3715072), ('allocation.all.allocated', 6636), ('allocation.all.current', 6636), ('allocation.all.freed', 0), ('allocation.all.peak', 6636), ('allocation.large_pool.allocated', 0), ('allocation.large_pool.current', 0), ('allocation.large_pool.freed', 0), ('allocation.large_pool.peak', 0), ('allocation.small_pool.allocated', 6636), ('allocation.small_pool.current', 6636), ('allocation.small_pool.freed', 0), ('allocation.small_pool.peak', 6636), ('inactive_split.all.allocated', 2), ('inactive_split.all.current', 1), ('inactive_split.all.freed', 1), ('inactive_split.all.peak', 1), ('inactive_split.large_pool.allocated', 0), ('inactive_split.large_pool.current', 0), ('inactive_split.large_pool.freed', 0), ('inactive_split.large_pool.peak', 0), ('inactive_split.small_pool.allocated', 2), ('inactive_split.small_pool.current', 1), ('inactive_split.small_pool.freed', 1), ('inactive_split.small_pool.peak', 1), ('inactive_split_bytes.all.allocated', 4193280), ('inactive_split_bytes.all.current', 479232), ('inactive_split_bytes.all.freed', 3714048), ('inactive_split_bytes.all.peak', 2096640), ('inactive_split_bytes.large_pool.allocated', 0), ('inactive_split_bytes.large_pool.current', 0), ('inactive_split_bytes.large_pool.freed', 0), ('inactive_split_bytes.large_pool.peak', 0), ('inactive_split_bytes.small_pool.allocated', 4193280), ('inactive_split_bytes.small_pool.current', 479232), ('inactive_split_bytes.small_pool.freed', 3714048), ('inactive_split_bytes.small_pool.peak', 2096640), ('max_split_size', -1), ('num_alloc_retries', 0), ('num_ooms', 0), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 406976), ('requested_bytes.all.current', 406976), ('requested_bytes.all.freed', 0), ('requested_bytes.all.peak', 406976), ('requested_bytes.large_pool.allocated', 0), ('requested_bytes.large_pool.current', 0), ('requested_bytes.large_pool.freed', 0), ('requested_bytes.large_pool.peak', 0), ('requested_bytes.small_pool.allocated', 406976), ('requested_bytes.small_pool.current', 406976), ('requested_bytes.small_pool.freed', 0), ('requested_bytes.small_pool.peak', 406976), ('reserved_bytes.all.allocated', 4194304), ('reserved_bytes.all.current', 4194304), ('reserved_bytes.all.freed', 0), ('reserved_bytes.all.peak', 4194304), ('reserved_bytes.large_pool.allocated', 0), ('reserved_bytes.large_pool.current', 0), ('reserved_bytes.large_pool.freed', 0), ('reserved_bytes.large_pool.peak', 0), ('reserved_bytes.small_pool.allocated', 4194304), ('reserved_bytes.small_pool.current', 4194304), ('reserved_bytes.small_pool.freed', 0), ('reserved_bytes.small_pool.peak', 4194304), ('segment.all.allocated', 2), ('segment.all.current', 2), ('segment.all.freed', 0), ('segment.all.peak', 2), ('segment.large_pool.allocated', 0), ('segment.large_pool.current', 0), ('segment.large_pool.freed', 0), ('segment.large_pool.peak', 0), ('segment.small_pool.allocated', 2), ('segment.small_pool.current', 2), ('segment.small_pool.freed', 0), ('segment.small_pool.peak', 2)])
**********
End of traceback message
Continuing with errors...
ERROR: Exception occured during runtime!
Hyperparameters: model_name: google/switch-base-128, Batch_size: 16, dataset_size: all, max_gen_length: 128, beam_size: 4, max_input_seq_length: -1, tokenizer_padding_setting: pad_to_max_length, dataset_name= wmt14 
Full traceback message:
**********Traceback (most recent call last):
  File "benchmark_suite.py", line 906, in <module>
    save_res_util=save_res_util,
  File "benchmark_suite.py", line 436, in call_batched
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/generation/utils.py", line 1604, in generate
    return self.beam_search(
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/generation/utils.py", line 2902, in beam_search
    outputs = self(
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1538, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1652, in forward
    decoder_outputs = self.decoder(
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1538, in _call_impl
    result = forward_call(*args, **kwargs)
  File "benchmark_suite.py", line 99, in timer_forward
    result = orig_forward(cls, *args, **kwargs)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 1090, in forward
    layer_outputs = layer_module(
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1538, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 743, in forward
    self_attention_outputs = self.layer[0](
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1538, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 645, in forward
    attention_output = self.SelfAttention(
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1538, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 564, in forward
    key_states = project(
  File "/home/wassim/miniconda3/envs/archer/lib/python3.8/site-packages/transformers/models/switch_transformers/modeling_switch_transformers.py", line 548, in project
    hidden_states = torch.cat([past_key_value, hidden_states], dim=2)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 23.69 GiB total capacity; 22.49 GiB already allocated; 11.12 MiB free; 23.07 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
OrderedDict([('active.all.allocated', 196044), ('active.all.current', 1511), ('active.all.freed', 194533), ('active.all.peak', 1550), ('active.large_pool.allocated', 9757), ('active.large_pool.current', 1376), ('active.large_pool.freed', 8381), ('active.large_pool.peak', 1379), ('active.small_pool.allocated', 186287), ('active.small_pool.current', 135), ('active.small_pool.freed', 186152), ('active.small_pool.peak', 220), ('active_bytes.all.allocated', 94872435200), ('active_bytes.all.current', 24143609856), ('active_bytes.all.freed', 70728825344), ('active_bytes.all.peak', 24155608064), ('active_bytes.large_pool.allocated', 84525879296), ('active_bytes.large_pool.current', 24134754304), ('active_bytes.large_pool.freed', 60391124992), ('active_bytes.large_pool.peak', 24147599360), ('active_bytes.small_pool.allocated', 10346555904), ('active_bytes.small_pool.current', 8855552), ('active_bytes.small_pool.freed', 10337700352), ('active_bytes.small_pool.peak', 73433088), ('allocated_bytes.all.allocated', 94872435200), ('allocated_bytes.all.current', 24143609856), ('allocated_bytes.all.freed', 70728825344), ('allocated_bytes.all.peak', 24155608064), ('allocated_bytes.large_pool.allocated', 84525879296), ('allocated_bytes.large_pool.current', 24134754304), ('allocated_bytes.large_pool.freed', 60391124992), ('allocated_bytes.large_pool.peak', 24147599360), ('allocated_bytes.small_pool.allocated', 10346555904), ('allocated_bytes.small_pool.current', 8855552), ('allocated_bytes.small_pool.freed', 10337700352), ('allocated_bytes.small_pool.peak', 73433088), ('allocation.all.allocated', 196044), ('allocation.all.current', 1511), ('allocation.all.freed', 194533), ('allocation.all.peak', 1550), ('allocation.large_pool.allocated', 9757), ('allocation.large_pool.current', 1376), ('allocation.large_pool.freed', 8381), ('allocation.large_pool.peak', 1379), ('allocation.small_pool.allocated', 186287), ('allocation.small_pool.current', 135), ('allocation.small_pool.freed', 186152), ('allocation.small_pool.peak', 220), ('inactive_split.all.allocated', 99941), ('inactive_split.all.current', 184), ('inactive_split.all.freed', 99757), ('inactive_split.all.peak', 203), ('inactive_split.large_pool.allocated', 5040), ('inactive_split.large_pool.current', 165), ('inactive_split.large_pool.freed', 4875), ('inactive_split.large_pool.peak', 183), ('inactive_split.small_pool.allocated', 94901), ('inactive_split.small_pool.current', 19), ('inactive_split.small_pool.freed', 94882), ('inactive_split.small_pool.peak', 62), ('inactive_split_bytes.all.allocated', 71279050240), ('inactive_split_bytes.all.current', 632143872), ('inactive_split_bytes.all.freed', 70646906368), ('inactive_split_bytes.all.peak', 794167808), ('inactive_split_bytes.large_pool.allocated', 60735512576), ('inactive_split_bytes.large_pool.current', 628416512), ('inactive_split_bytes.large_pool.freed', 60107096064), ('inactive_split_bytes.large_pool.peak', 789012480), ('inactive_split_bytes.small_pool.allocated', 10543537664), ('inactive_split_bytes.small_pool.current', 3727360), ('inactive_split_bytes.small_pool.freed', 10539810304), ('inactive_split_bytes.small_pool.peak', 27439104), ('max_split_size', -1), ('num_alloc_retries', 2), ('num_ooms', 1), ('oversize_allocations.allocated', 0), ('oversize_allocations.current', 0), ('oversize_allocations.freed', 0), ('oversize_allocations.peak', 0), ('oversize_segments.allocated', 0), ('oversize_segments.current', 0), ('oversize_segments.freed', 0), ('oversize_segments.peak', 0), ('requested_bytes.all.allocated', 94021803688), ('requested_bytes.all.current', 24143581656), ('requested_bytes.all.freed', 69878222032), ('requested_bytes.all.peak', 24151353560), ('requested_bytes.large_pool.allocated', 83715094016), ('requested_bytes.large_pool.current', 24134754304), ('requested_bytes.large_pool.freed', 59580339712), ('requested_bytes.large_pool.peak', 24143372288), ('requested_bytes.small_pool.allocated', 10306709672), ('requested_bytes.small_pool.current', 8827352), ('requested_bytes.small_pool.freed', 10297882320), ('requested_bytes.small_pool.peak', 73428377), ('reserved_bytes.all.allocated', 27109883904), ('reserved_bytes.all.current', 24775753728), ('reserved_bytes.all.freed', 2334130176), ('reserved_bytes.all.peak', 24775753728), ('reserved_bytes.large_pool.allocated', 26914848768), ('reserved_bytes.large_pool.current', 24763170816), ('reserved_bytes.large_pool.freed', 2151677952), ('reserved_bytes.large_pool.peak', 24763170816), ('reserved_bytes.small_pool.allocated', 195035136), ('reserved_bytes.small_pool.current', 12582912), ('reserved_bytes.small_pool.freed', 182452224), ('reserved_bytes.small_pool.peak', 88080384), ('segment.all.allocated', 1502), ('segment.all.current', 1293), ('segment.all.freed', 209), ('segment.all.peak', 1325), ('segment.large_pool.allocated', 1409), ('segment.large_pool.current', 1287), ('segment.large_pool.freed', 122), ('segment.large_pool.peak', 1287), ('segment.small_pool.allocated', 93), ('segment.small_pool.current', 6), ('segment.small_pool.freed', 87), ('segment.small_pool.peak', 42)])
**********
End of traceback message
Attempting to reduce batch size and retrying...
